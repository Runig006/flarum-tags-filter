(()=>{var t={n:e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return t.d(o,{a:o}),o},d:(e,o)=>{for(var r in o)t.o(o,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:o[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e),t.d(e,{getSelected:()=>O,refreshTags:()=>b});const o=flarum.core.compat["common/extend"],r=flarum.core.compat["forum/app"];var n=t.n(r);const a=flarum.core.compat["forum/components/IndexPage"];var c=t.n(a);function i(){return i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r])}return t},i.apply(this,arguments)}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}flarum.core.compat["forum/components/Page"],flarum.core.compat["common/Component"];const s=flarum.core.compat["common/components/Button"];var u=t.n(s);const p=flarum.core.compat["common/components/Dropdown"];var f=t.n(p);const g=flarum.core.compat["common/utils/ItemList"];var d=t.n(g),v=function(t){var e,o;function r(){return t.apply(this,arguments)||this}o=t,(e=r).prototype=Object.create(o.prototype),e.prototype.constructor=e,l(e,o),r.initAttrs=function(e){t.initAttrs.call(this,e),e.label="Tags",e.className="TagFilter",e.buttonClassName="TagFilter-item Button",e.menuClassName="Dropdown-menu--right"};var a=r.prototype;return a.view=function(e){return t.prototype.view.call(this,i({},e,{children:this.items().toArray()}))},a.items=function(){var t=O(),e=n().store.all("tags"),o=new(d()),r=this;return e.forEach((function(e){var n="Button";t.indexOf(e.slug())>=0&&(n+=" active"),o.add(e.slug(),u().component({class:n,onclick:function(){r.handleTagChange(e)}},e.name()))})),o},a.handleTagChange=function(t){var e=O(),o=e.indexOf(t.slug());o>=0?e.splice(o,1):e.push(t.slug()),localStorage.setItem("spy-tags-filters",JSON.stringify(e)),b()},r}(f());const y=flarum.core.compat["forum/states/GlobalSearchState"];var h=t.n(y);function O(){var t=localStorage.getItem("spy-tags-filters");return t?JSON.parse(t):[]}function b(){var t=n().search.params(),e=O();e.length>0?t.tag=e.join(","):(t.tag=null,delete t.tag),n().discussions.refreshParams(t,2)}n().initializers.add("runig006/user-filter",(function(){(0,o.extend)(c().prototype,"viewItems",(function(t){-1!=["index","following"].indexOf(n().current.data.routeName)&&t.add("filter-tags",m(v,null))})),(0,o.extend)(c().prototype,"oninit",(function(t){null==n().previous.type&&b()})),(0,o.extend)(h().prototype,"params",(function(t){var e=O();null==t.filter&&(t.filter={}),e.length>0&&(t.filter.tag=e.join(","))}))}))})(),module.exports=e})();
//# sourceMappingURL=forum.js.map